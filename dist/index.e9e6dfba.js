function t(t,e,n,a){Object.defineProperty(t,e,{get:n,set:a,enumerable:!0,configurable:!0})}function e(t){return t&&t.__esModule?t.default:t}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},o={},i=n.parcelRequire94c2;null==i&&((i=function(t){if(t in a)return a[t].exports;if(t in o){var e=o[t];delete o[t];var n={id:t,exports:{}};return a[t]=n,e.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(t,e){o[t]=e},n.parcelRequire94c2=i),i.register("27Lyk",(function(e,n){var a,o;t(e.exports,"register",(()=>a),(t=>a=t)),t(e.exports,"resolve",(()=>o),(t=>o=t));var i={};a=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)i[e[n]]=t[e[n]]},o=function(t){var e=i[t];if(null==e)throw new Error("Could not resolve bundle with id "+t);return e}})),i("27Lyk").register(JSON.parse('{"bB9dn":"index.e9e6dfba.js","erjYX":"document.62bed16a.png","97kzZ":"greeting.08a821e6.png"}'));var c;c=new URL(i("27Lyk").resolve("erjYX"),import.meta.url).toString();const r=({selector:t})=>document.querySelector(t),s=({tagName:t,attrs:e=null})=>{const n=document.createElement(t);return e&&e.forEach((({attr:t,value:e})=>{"textContent"!==t?n.setAttribute(t,e):n.textContent=e})),n},d=window.localStorage,u=t=>{try{const e=d.getItem(t);return e?JSON.parse(e):{title:"",content:""}}catch(t){alert(t.message),console.error(t.message)}},l=(t,e)=>{d.setItem(t,JSON.stringify(e))},m=t=>{d.removeItem(t)},p=(t,e)=>{let n=null;return(...a)=>{n&&clearTimeout(n),n=setTimeout((()=>{t(...a)}),e)}},h=({router:t})=>{window.addEventListener("routeChange",(({detail:e})=>{const{nextUrl:n}=e;n&&(history.pushState(null,null,n),t())}))},g=({nextUrl:t})=>{window.dispatchEvent(new CustomEvent("routeChange",{detail:{nextUrl:t}}))};function w({$target:t,onClickDocument:n,onAddDocument:a,onDeleteDocument:o}){let i=[];const r=s({tagName:"div",attrs:[{attr:"class",value:"document-list"}]}),d=({id:t,title:n,documents:a,margin:o})=>`\n            <details id="detail-${t}" style="margin-left:${o}px" ${i.includes(String(t))&&"open"}>\n                <summary class="toggle" data-index="${t}">\n                <img class="doc-img" src=${e(c)} alt="doc-img"/>\n                <span>${n||"제목 없음"}</span>\n                <span class="option-container">\n                    <input type="button" class="option-btn remove" />\n                    <input type="button" class="option-btn add" />\n                </span>\n                </summary>\n                ${a.length?a.map((({id:t,title:e,documents:n})=>d({id:t,title:e,documents:n,margin:o+10}))).join(""):`<p style="margin-left:${o+5}px">하위 페이지가 없습니다.</p>`}\n            </details>\n        `,u=({document:t})=>`\n            <h1>Documents</h1>\n            ${t.map((({id:t,title:e,documents:n})=>d({id:t,title:e,documents:n,margin:0}))).join("")}\n        `;this.render=({document:e})=>{r.innerHTML=u({document:e}),t.appendChild(r)},this.setState=({nextState:t,openState:e})=>{i=[...e],r.innerHTML=u({document:t})},r.addEventListener("click",(async t=>{const{target:e}=t,i=e.tagName,c=e.closest("summary");if("H1"!==i){if(c&&"INPUT"!==i){const{index:t}=c.dataset;return g({nextUrl:`/documents/${t}`}),void await n({docId:t})}if("INPUT"===i){const{classList:t}=e,{index:n}=c.dataset;if(t.contains("remove")){if(confirm("삭제하시겠습니까?")){await o({docId:n});const t=c.closest("details").parentNode?.id;if(alert("삭제되었습니다."),t){const e=t.split("-").at(-1);g({nextUrl:`/documents/${e}`})}else g({nextUrl:"/"})}return}if(t.contains("add"))return void await a({docId:n})}}else g({nextUrl:"/"})}))}function f({$target:t,compareStateWithStoredState:n,storeAtStorageWhileInput:a,onEditDocument:o}){let i=!1,s={title:"",content:""};this.render=({state:a})=>{t.innerHTML='\n            <input type="text" name="title" class="document-edit-input" placeholder="제목 없음" autofocus />\n            <textarea class="document-edit-textarea" name="content" placeholder="내용 없음"></textarea>\n            <div class="sub-document"></div>\n        ',(async({nextState:a})=>{i||(t.innerHTML='\n            <input type="text" name="title" class="document-edit-input" placeholder="제목 없음" autofocus />\n            <textarea class="document-edit-textarea" name="content" placeholder="내용 없음"></textarea>\n            <div class="sub-document"></div>\n        ',i=!0);const o=r({selector:".document-edit-input"}),d=r({selector:".document-edit-textarea"}),u=r({selector:".sub-document"});s=await n({nextState:a,state:s});const{title:l,content:m,documents:p}=s;o.value=l,d.value=m||"",u.innerHTML=p.map((({id:t,title:n})=>`\n            <button class="sub-document-item" data-index="${t}">\n                <img class="doc-img" src=${e(c)} alt="doc-img"/>\n                ${n||"제목없음"}\n            </button>`)).join("")})({nextState:a})},t.addEventListener("input",(async t=>{s={...s,[t.target.name]:t.target.value,updatedAt:new Date},await a({state:s}),await o({docId:s.id,content:s})})),t.addEventListener("click",(({target:t})=>{const{tagName:e}=t;if("BUTTON"===e){const e=t.dataset.index;g({nextUrl:`/documents/${e}`})}}))}function D({$target:t,onEditDocument:e}){const n=new f({$target:t,compareStateWithStoredState:async({nextState:t,state:n})=>{const{id:a}=t,o=`document-${a}`,i=u(o);if(i&&i.updatedAt>t.updatedAt&&confirm("이미 저장된 내용이 있습니다. 저장하시겠습니까?")){const{id:t,title:a,content:c}=i;return await e({docId:t,content:{title:a,content:c}}),m(o),{...n,...i}}return{...n,...t}},storeAtStorageWhileInput:p((({state:t})=>{const{id:e}=t;l(`document-${e}`,t)}),800),onEditDocument:p(e,1e3)});this.render=({state:t})=>{n.render({state:t})}}var y;function S({$target:t}){this.render=()=>{t.innerHTML=`<img class="greeting-img" src="${e(y)}" alt="greeting-img"/>`}}function x({$target:t,onAddDocument:e}){const n=s({tagName:"button",attrs:[{attr:"class",value:"document-add-btn"},{attr:"textContent",value:"+ 새 페이지"}]});this.render=()=>{t.appendChild(n)},n.addEventListener("click",(async()=>{await e({docId:null})}))}function $({$target:t}){this.render=()=>{t.innerHTML='<img class="not-found-img" src="https://i.imgur.com/EQJG7Qb.png" alt="Not Found" />'}}function v({$target:t,documents:e,onClickDocument:n,onAddDocument:a,onDeleteDocument:o}){let i=e;const c=s({tagName:"aside"}),r=new w({$target:c,onClickDocument:n,onAddDocument:a,onDeleteDocument:o}),d=new x({$target:c,onAddDocument:a});this.render=()=>{t.appendChild(c),r.render({document:i}),d.render()},this.setState=({nextState:t,openState:e})=>{i=t,r.setState({nextState:i,openState:e})}}function E({$target:t,onGetOneDocument:e,onEditDocument:n}){const a=s({tagName:"section"}),o=new S({$target:a}),i=new D({$target:a,onEditDocument:n}),c=new $({$target:a}),r=async()=>{const{pathname:t}=window.location;if("/"!==t){if(t.includes("/documents/")){const n=t.split("/").at(-1),a=await e({docId:n});return a?void i.render({state:a}):void c.render()}c.render()}else o.render()};this.render=()=>{t.appendChild(a),r(),h({router:()=>r()})}}y=new URL(i("27Lyk").resolve("97kzZ"),import.meta.url).toString();const T=async({path:t,method:e,content:n=""})=>{try{const a=(({method:t,content:e})=>({method:t,headers:{"x-username":"yeummy-sk",["POST"===t||"PUT"===t?"Content-Type":"Accept"]:"application/json"},["POST"===t||"PUT"===t?"body":"params"]:JSON.stringify(e)}))({method:e,content:n}),o=await fetch((({path:t})=>`https://kdt-frontend.programmers.co.kr/documents${t}`)({path:t}),a);if(!o||!o.ok)throw Error(o.status);return await o.json()}catch(t){alert(t.message),console.error(t.message)}};var b={GET:async({path:t})=>await T({path:t,method:"GET"}),POST:async({path:t,content:e})=>await T({path:t,method:"POST",content:e}),PUT:async({path:t,content:e})=>await T({path:t,method:"PUT",content:e}),DELETE:async({path:t})=>await T({path:t,method:"DELETE"})};const A=async({method:t,content:e="",id:n=""})=>{try{return await b[t]((()=>{switch(t){case"GET":return Boolean(n)?{path:`/${n}`}:{path:""};case"POST":return{path:"",content:e};case"PUT":return{path:`/${n}`,content:e};case"DELETE":return{path:`/${n}`};default:throw new Error("잘못된 method 입니다.")}})())}catch(t){alert(t.message),console.error(t.message)}};var L={getAllDocuments:async()=>await A({method:"GET"}),getOneDocument:async({id:t})=>await A({method:"GET",id:t}),createDocument:async({content:t})=>await A({method:"POST",content:t}),editDocument:async({id:t,content:e})=>await A({method:"PUT",id:t,content:e}),deleteDocument:async({id:t})=>await A({method:"DELETE",id:t})};var O=class{constructor({$target:t,initialState:e}){this.openState=[],this.$target=t,this.sideBar=new v({$target:this.$target,documents:e,onClickDocument:this.onClickDocument.bind(this),onAddDocument:this.onAddDocument.bind(this),onDeleteDocument:this.onDeleteDocument.bind(this)}),this.documentPage=new E({$target:this.$target,onGetOneDocument:this.onGetOneDocument.bind(this),onEditDocument:this.onEditDocument.bind(this)})}async onGetAllDocument(){return await L.getAllDocuments()}async onGetOneDocument({docId:t}){return await L.getOneDocument({id:t})}async onClickDocument({docId:t}){if(await L.getOneDocument({id:t}),this.openState.includes(t)){const e=this.openState.indexOf(t);this.openState.splice(e,1)}else this.openState.push(t);g({nextUrl:`/documents/${t}`})}async onAddDocument({docId:t}){const e=await L.createDocument({content:{title:"",parent:t}}),n=await this.onGetAllDocument();this.sideBar.setState({nextState:n,openState:this.openState}),g({nextUrl:`/documents/${e.id}`})}async onDeleteDocument({docId:t}){await L.deleteDocument({id:t});const e=await this.onGetAllDocument();this.sideBar.setState({nextState:e,openState:this.openState})}async onEditDocument({docId:t,content:e}){const n=await L.editDocument({id:t,content:e});r({selector:`[data-index="${t}"] > span`}).innerText=n.title,m(`document-${t}`)}render(){this.sideBar.render(),this.documentPage.render()}};(new function(){this.init=async()=>{try{const t=r({selector:"main"});new O({$target:t,initialState:await L.getAllDocuments()}).render()}catch(t){alert(t.message),console.error(t.message)}}}).init();
//# sourceMappingURL=index.e9e6dfba.js.map
